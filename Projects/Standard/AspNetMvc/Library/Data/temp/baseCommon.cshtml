@using OnXap
@using OnXap.Core.Modules
@using OnXap.Modules.Admin
@using OnXap.Modules.Auth
@using OnXap.Modules.Customer
@{
    var g = this;

    if (string.IsNullOrEmpty(this.GetTitle()))
    {
        if (this.GetModule() != null && !string.IsNullOrEmpty(this.GetModule().Caption)) { this.SetTitle(this.GetModule().Caption); }
    }

    if (string.IsNullOrEmpty(this.GetDescription()))
    {
        this.SetDescription(this.GetConfig().site_descr.Replace(" \"", "&quot;"));
    }

    if (string.IsNullOrEmpty(this.GetKeywords()))
    {
        this.SetKeywords(this.GetConfig().site_keys.Replace(" \"", "&quot;"));
    }

    var moduleAdmin = this.GetAppCore().GetModulesManager().GetModule<ModuleAdmin>();
}

<!DOCTYPE html>
<html lang="ru" @RenderSection("htmlTagAttributes", false)>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="author" content="">

    <title>@this.GetTitle() : @this.GetConfig().SiteFullName</title>

    <meta name="description" content="@this.GetDescription()" />
    <meta name="keywords" content="@this.GetKeywords()" />

    <script src="~/Design/UI/vue/vue.min.js"></script>
    <script src="~/Design/UI/primevuelibrary/quill.min.js"></script>
    <script src="~/Design/UI/primevuelibrary/primevuelibrary.min.js"></script>

    <link href="~/Design/UI/primevuelibrary/primevuelibrary.min.css " rel="stylesheet">
    <link href="~/Design/UI/primevuelibrary/themes/nova-light/theme.css " rel="stylesheet">

    <script type="text/javascript" src="~/Design/UI/jquery/jquery.min.js"></script>
    <link rel="stylesheet" href="~/Design/UI/jqueryui/jquery-ui.min.css" />
    <script type="text/javascript" src="~/Design/UI/jqueryui/jquery-ui.min.js"></script>

    <link rel="stylesheet" href="/data/css/main.css">
    <link rel="stylesheet" href="/data/css/font-awesome.min.css">

    <script src='https://code.jquery.com/jquery-migrate-1.2.1.min.js'></script>

    <script type="text/javascript" src="/data/js/common.js"></script>
    <script type="text/javascript" src="/data/js/work.js"></script>

    <script src="https://cdn.jsdelivr.net/npm/js-cookie@2/src/js.cookie.min.js"></script>

    <script type="text/javascript" src="/data/js/arcticmodal/jquery.arcticmodal-0.3.min.js"></script>
    <link rel="stylesheet" type="text/css" href="/data/js/arcticmodal/jquery.arcticmodal-0.3.css" />
    <link rel="stylesheet" type="text/css" href="/data/js/arcticmodal/themes/simple.css" />

    @RenderSection("head", false)

</head>
<body @RenderSection("bodyTagAttributes", false)>

    @RenderSection("bodyTagAfter", false)

    <!-- (wrapper) -->
    <div class="wrapper">
        <!-- (main-header) -->
        <div class="main-header">
            <!-- (top-block) -->
            <div class="top-block">
                <div class="top-block__cover cover clearfix">
                    @RenderSection("logoTop", false)
                    <!-- (info-top-block) -->
                    <div class="info-top-block clearfix">
                        <div class="info-top-list clearfix">
                            <div class="info-top-list__item">
                                @if (!this.GetCurrentUserContext().IsGuest)
                                {
                                    <a href="@(Url.CreateRoute<ModuleCustomer, ModuleControllerCustomer>())">
                                        <div>
                                            <img src="@(this.GetCurrentUserContext().GetData().IdPhoto.HasValue ? "/fm/imageCrop/" + this.GetCurrentUserContext().GetData().IdPhoto + "?MaxHeight=100&MaxWidth=100" : "/data/images/nophoto_user.jpg")" alt="">
                                            <div class="top-user__name">Личный кабинет</div>
                                        </div>
                                    </a>

                                }
                                else
                                {
                                    <a href="@(Url.CreateRoute<ModuleAuth, ModuleAuthController>())" title="">
                                        <div>
                                            Войти<span class="top-login__text-hidden"> в кабинет</span>
                                        </div>
                                    </a>
                                }
                            </div>
                            @if (moduleAdmin != null && moduleAdmin.CheckPermission(this.GetCurrentUserContext(), ModulesConstants.PermissionManage) == CheckPermissionResult.Allowed)
                            {
                                <div class="info-top-list__item list-admin">
                                    <a href="/@moduleAdmin.UrlName" class="top-user" target="_blank">
                                        <div class="top-user__content">
                                            <div class="top-user__name">Управление сайтом</div>
                                        </div>
                                    </a>
                                </div>
                            }
                            @RenderSection("breadcrumbs", false)
                        </div>
                    </div>
                    <!-- End (info-top-block) -->
                </div>
            </div>
            <!-- End (top-block) -->

            @RenderSection("headerAfter", false)

        </div>
        <!-- End (main-header) -->

        @RenderSection("mainBefore", false)

        <!-- (main-content) -->
        @RenderBody()
        <!-- End (main-content) -->

        @RenderSection("mainAfter", false)

    </div>

    <!-- End (wrapper) -->

    @RenderSection("wrapperAfter", false)

    <!-- (popup-dialog) -->
    <div class="none">
        <div class="popup popup-dialog" id="popup-dialog">
            <div class="popup__content">

            </div>
            <div class="popup__buttons">

            </div>
        </div>
    </div>
    <!-- End (popup-dialog) -->

    @RenderSection("scripts", false)
    @RenderSection("stats", false)
</body>
</html>